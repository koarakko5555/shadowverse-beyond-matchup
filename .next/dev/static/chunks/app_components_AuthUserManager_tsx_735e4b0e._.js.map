{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/k-hosaka/Project/private-dev/shadowverse-beyond-matchup/app/components/AuthUserManager.tsx"],"sourcesContent":["\"use client\";\n\nimport { useState, useTransition } from \"react\";\n\ntype UserRow = {\n  id: number;\n  name: string;\n  role: \"ADMIN\" | \"MEMBER\";\n  createdAt: string;\n};\n\ntype Props = {\n  users: UserRow[];\n  isAdmin: boolean;\n  currentUserId?: number;\n};\n\nexport default function AuthUserManager({\n  users,\n  isAdmin,\n  currentUserId,\n}: Props) {\n  const [isPending, startTransition] = useTransition();\n  const [error, setError] = useState<string | null>(null);\n  const [rows, setRows] = useState<UserRow[]>(users);\n\n  const updateRole = async (userId: number, role: \"ADMIN\" | \"MEMBER\") => {\n    setError(null);\n    const res = await fetch(\"/api/admin/users/role\", {\n      method: \"POST\",\n      headers: { \"Content-Type\": \"application/json\" },\n      body: JSON.stringify({ id: userId, role }),\n    });\n\n    if (!res.ok) {\n      const data = await res.json().catch(() => ({}));\n      setError(data?.error ?? \"更新に失敗しました。\");\n      return;\n    }\n\n    startTransition(() => {\n      setRows((prev) =>\n        prev.map((row) => (row.id === userId ? { ...row, role } : row))\n      );\n    });\n  };\n\n  return (\n    <section className=\"rounded-2xl border border-zinc-200 bg-white p-6 shadow-sm\">\n      <div>\n        <p className=\"text-xs font-semibold uppercase tracking-[0.3em] text-zinc-400\">\n          Users\n        </p>\n        <h2 className=\"mt-2 text-2xl font-semibold text-zinc-900\">\n          認証ユーザー管理\n        </h2>\n      </div>\n\n      {!isAdmin && (\n        <p className=\"mt-4 text-sm text-red-600\">\n          管理者権限がないため、ロール変更はできません。\n        </p>\n      )}\n      {error && <p className=\"mt-3 text-sm text-red-600\">{error}</p>}\n\n      <div className=\"mt-6 overflow-x-auto\">\n        <table className=\"min-w-full text-left text-sm text-zinc-700\">\n          <thead className=\"border-b border-zinc-200 bg-zinc-50 text-xs uppercase tracking-wider text-zinc-400\">\n            <tr>\n              <th className=\"px-3 py-2\">表示名</th>\n              <th className=\"px-3 py-2\">ロール</th>\n              <th className=\"px-3 py-2\">登録日</th>\n              <th className=\"px-3 py-2 text-center\">操作</th>\n            </tr>\n          </thead>\n          <tbody>\n            {rows.map((user) => (\n              <tr key={user.id} className=\"border-b border-zinc-100\">\n                <td className=\"px-3 py-3 font-semibold text-zinc-900\">\n                  {user.name}\n                </td>\n                <td className=\"px-3 py-3\">\n                  <select\n                    className=\"rounded-lg border border-zinc-200 px-2 py-1 text-sm text-zinc-900\"\n                    value={user.role}\n                    onChange={(event) =>\n                      updateRole(\n                        user.id,\n                        event.target.value === \"ADMIN\" ? \"ADMIN\" : \"MEMBER\"\n                      )\n                    }\n                    disabled={\n                      !isAdmin ||\n                      isPending ||\n                      (currentUserId && user.id === currentUserId)\n                    }\n                  >\n                    <option value=\"ADMIN\">admin</option>\n                    <option value=\"MEMBER\">member</option>\n                  </select>\n                </td>\n                <td className=\"px-3 py-3 text-xs text-zinc-500\">\n                  {new Date(user.createdAt).toLocaleDateString(\"ja-JP\")}\n                </td>\n                <td className=\"px-3 py-3 text-center text-xs text-zinc-500\">\n                  {currentUserId === user.id ? \"現在のユーザー\" : \"—\"}\n                </td>\n              </tr>\n            ))}\n          </tbody>\n        </table>\n      </div>\n    </section>\n  );\n}\n"],"names":[],"mappings":";;;;;AAEA;;;AAFA;;AAiBe,SAAS,gBAAgB,EACtC,KAAK,EACL,OAAO,EACP,aAAa,EACP;;IACN,MAAM,CAAC,WAAW,gBAAgB,GAAG,IAAA,8KAAa;IAClD,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,yKAAQ,EAAgB;IAClD,MAAM,CAAC,MAAM,QAAQ,GAAG,IAAA,yKAAQ,EAAY;IAE5C,MAAM,aAAa,OAAO,QAAgB;QACxC,SAAS;QACT,MAAM,MAAM,MAAM,MAAM,yBAAyB;YAC/C,QAAQ;YACR,SAAS;gBAAE,gBAAgB;YAAmB;YAC9C,MAAM,KAAK,SAAS,CAAC;gBAAE,IAAI;gBAAQ;YAAK;QAC1C;QAEA,IAAI,CAAC,IAAI,EAAE,EAAE;YACX,MAAM,OAAO,MAAM,IAAI,IAAI,GAAG,KAAK,CAAC,IAAM,CAAC,CAAC,CAAC;YAC7C,SAAS,MAAM,SAAS;YACxB;QACF;QAEA,gBAAgB;YACd,QAAQ,CAAC,OACP,KAAK,GAAG,CAAC,CAAC,MAAS,IAAI,EAAE,KAAK,SAAS;wBAAE,GAAG,GAAG;wBAAE;oBAAK,IAAI;QAE9D;IACF;IAEA,qBACE,6LAAC;QAAQ,WAAU;;0BACjB,6LAAC;;kCACC,6LAAC;wBAAE,WAAU;kCAAiE;;;;;;kCAG9E,6LAAC;wBAAG,WAAU;kCAA4C;;;;;;;;;;;;YAK3D,CAAC,yBACA,6LAAC;gBAAE,WAAU;0BAA4B;;;;;;YAI1C,uBAAS,6LAAC;gBAAE,WAAU;0BAA6B;;;;;;0BAEpD,6LAAC;gBAAI,WAAU;0BACb,cAAA,6LAAC;oBAAM,WAAU;;sCACf,6LAAC;4BAAM,WAAU;sCACf,cAAA,6LAAC;;kDACC,6LAAC;wCAAG,WAAU;kDAAY;;;;;;kDAC1B,6LAAC;wCAAG,WAAU;kDAAY;;;;;;kDAC1B,6LAAC;wCAAG,WAAU;kDAAY;;;;;;kDAC1B,6LAAC;wCAAG,WAAU;kDAAwB;;;;;;;;;;;;;;;;;sCAG1C,6LAAC;sCACE,KAAK,GAAG,CAAC,CAAC,qBACT,6LAAC;oCAAiB,WAAU;;sDAC1B,6LAAC;4CAAG,WAAU;sDACX,KAAK,IAAI;;;;;;sDAEZ,6LAAC;4CAAG,WAAU;sDACZ,cAAA,6LAAC;gDACC,WAAU;gDACV,OAAO,KAAK,IAAI;gDAChB,UAAU,CAAC,QACT,WACE,KAAK,EAAE,EACP,MAAM,MAAM,CAAC,KAAK,KAAK,UAAU,UAAU;gDAG/C,UACE,CAAC,WACD,aACC,iBAAiB,KAAK,EAAE,KAAK;;kEAGhC,6LAAC;wDAAO,OAAM;kEAAQ;;;;;;kEACtB,6LAAC;wDAAO,OAAM;kEAAS;;;;;;;;;;;;;;;;;sDAG3B,6LAAC;4CAAG,WAAU;sDACX,IAAI,KAAK,KAAK,SAAS,EAAE,kBAAkB,CAAC;;;;;;sDAE/C,6LAAC;4CAAG,WAAU;sDACX,kBAAkB,KAAK,EAAE,GAAG,YAAY;;;;;;;mCA5BpC,KAAK,EAAE;;;;;;;;;;;;;;;;;;;;;;;;;;;AAqC9B;GAjGwB;;QAKe,8KAAa;;;KAL5B"}}]
}