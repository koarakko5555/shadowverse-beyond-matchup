{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 16, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/middleware.ts"],"sourcesContent":["import { NextResponse, type NextRequest } from \"next/server\";\nimport { jwtVerify } from \"jose\";\n\nconst isAuthRoute = (pathname: string) =>\n  pathname.startsWith(\"/login\") || pathname.startsWith(\"/signup\");\n\nconst SESSION_COOKIE = \"sv_session\";\n\nconst getSession = async (token?: string) => {\n  if (!token || !process.env.AUTH_SECRET) return null;\n  try {\n    const { payload } = await jwtVerify(\n      token,\n      new TextEncoder().encode(process.env.AUTH_SECRET)\n    );\n    return payload;\n  } catch {\n    return null;\n  }\n};\n\nexport async function middleware(request: NextRequest) {\n  const token = request.cookies.get(SESSION_COOKIE)?.value;\n  const session = await getSession(token);\n\n  const pathname = request.nextUrl.pathname;\n  const isProtected =\n    pathname.startsWith(\"/packs\") ||\n    pathname.startsWith(\"/decks\") ||\n    pathname.startsWith(\"/matchups\") ||\n    pathname.startsWith(\"/records\") ||\n    pathname.startsWith(\"/users\") ||\n    pathname.startsWith(\"/stats\");\n\n  if (isProtected && !session) {\n    const loginUrl = new URL(\"/login\", request.url);\n    return NextResponse.redirect(loginUrl);\n  }\n\n  if (session && isAuthRoute(pathname)) {\n    return NextResponse.redirect(new URL(\"/packs\", request.url));\n  }\n\n  return NextResponse.next();\n}\n\nexport const config = {\n  matcher: [\n    \"/packs/:path*\",\n    \"/decks/:path*\",\n    \"/matchups/:path*\",\n    \"/records/:path*\",\n    \"/users/:path*\",\n    \"/stats/:path*\",\n    \"/login\",\n    \"/signup\",\n  ],\n};\n"],"names":[],"mappings":";;;;;;AAAA;AAAA;AACA;;;AAEA,MAAM,cAAc,CAAC,WACnB,SAAS,UAAU,CAAC,aAAa,SAAS,UAAU,CAAC;AAEvD,MAAM,iBAAiB;AAEvB,MAAM,aAAa,OAAO;IACxB,IAAI,CAAC,SAAS,CAAC,QAAQ,GAAG,CAAC,WAAW,EAAE,OAAO;IAC/C,IAAI;QACF,MAAM,EAAE,OAAO,EAAE,GAAG,MAAM,IAAA,4KAAS,EACjC,OACA,IAAI,cAAc,MAAM,CAAC,QAAQ,GAAG,CAAC,WAAW;QAElD,OAAO;IACT,EAAE,OAAM;QACN,OAAO;IACT;AACF;AAEO,eAAe,WAAW,OAAoB;IACnD,MAAM,QAAQ,QAAQ,OAAO,CAAC,GAAG,CAAC,iBAAiB;IACnD,MAAM,UAAU,MAAM,WAAW;IAEjC,MAAM,WAAW,QAAQ,OAAO,CAAC,QAAQ;IACzC,MAAM,cACJ,SAAS,UAAU,CAAC,aACpB,SAAS,UAAU,CAAC,aACpB,SAAS,UAAU,CAAC,gBACpB,SAAS,UAAU,CAAC,eACpB,SAAS,UAAU,CAAC,aACpB,SAAS,UAAU,CAAC;IAEtB,IAAI,eAAe,CAAC,SAAS;QAC3B,MAAM,WAAW,IAAI,IAAI,UAAU,QAAQ,GAAG;QAC9C,OAAO,gMAAY,CAAC,QAAQ,CAAC;IAC/B;IAEA,IAAI,WAAW,YAAY,WAAW;QACpC,OAAO,gMAAY,CAAC,QAAQ,CAAC,IAAI,IAAI,UAAU,QAAQ,GAAG;IAC5D;IAEA,OAAO,gMAAY,CAAC,IAAI;AAC1B;AAEO,MAAM,SAAS;IACpB,SAAS;QACP;QACA;QACA;QACA;QACA;QACA;QACA;QACA;KACD;AACH"}}]
}