{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/k-hosaka/Project/private-dev/shadowverse-beyond-matchup/app/components/StatsTable.tsx"],"sourcesContent":[" \"use client\";\n\nimport { useEffect, useMemo, useState } from \"react\";\n\ntype CardPack = {\n  id: number;\n  name: string;\n};\n\ntype Deck = {\n  id: number;\n  name: string;\n  deckClass: string;\n  cardPack: CardPack;\n};\n\ntype Matchup = {\n  id: number;\n  deck1: Deck;\n  deck2: Deck;\n  user: User;\n  winRate: number;\n};\n\ntype Props = {\n  decks: Deck[];\n  matchups: Matchup[];\n  embedded?: boolean;\n};\n\ntype User = {\n  id: number;\n  name: string;\n};\n\nconst deckClassLabels: Record<string, string> = {\n  ELF: \"エルフ\",\n  ROYAL: \"ロイヤル\",\n  WITCH: \"ウィッチ\",\n  NIGHTMARE: \"ナイトメア\",\n  DRAGON: \"ドラゴン\",\n  BISHOP: \"ビショップ\",\n  NEMESIS: \"ネメシス\",\n};\n\nconst deckClassOrder = [\n  \"ELF\",\n  \"ROYAL\",\n  \"WITCH\",\n  \"DRAGON\",\n  \"NIGHTMARE\",\n  \"BISHOP\",\n  \"NEMESIS\",\n] as const;\nconst deckClassRank = new Map<string, number>(\n  deckClassOrder.map((value, index) => [value, index])\n);\n\nconst buildAverageStats = (decks: Deck[], matchups: Matchup[]) =>\n  decks\n    .map((deck) => {\n      const scores: number[] = [];\n      for (const matchup of matchups) {\n        if (matchup.deck1.id === deck.id) {\n          scores.push(matchup.winRate);\n        } else if (matchup.deck2.id === deck.id) {\n          scores.push(100 - matchup.winRate);\n        }\n      }\n      const total = scores.reduce((sum, value) => sum + value, 0);\n      const avg = scores.length ? total / scores.length : null;\n      return {\n        deckId: deck.id,\n        name: deck.name,\n        deckClass: deck.deckClass,\n        cardPack: deck.cardPack.name,\n        average: avg,\n        count: scores.length,\n      };\n    })\n    .sort((a, b) => {\n      if (a.average === null && b.average === null) {\n        return a.name.localeCompare(b.name, \"ja-JP\");\n      }\n      if (a.average === null) return 1;\n      if (b.average === null) return -1;\n      return b.average - a.average;\n    });\n\nconst buildMatchupMatrix = (decks: Deck[], matchups: Matchup[]) => {\n  const totals = new Map<string, { sum: number; count: number }>();\n  for (const matchup of matchups) {\n    const lowId = Math.min(matchup.deck1.id, matchup.deck2.id);\n    const highId = Math.max(matchup.deck1.id, matchup.deck2.id);\n    const key = `${lowId}:${highId}`;\n    const winRateFromLow =\n      matchup.deck1.id === lowId ? matchup.winRate : 100 - matchup.winRate;\n    const entry = totals.get(key) ?? { sum: 0, count: 0 };\n    entry.sum += winRateFromLow;\n    entry.count += 1;\n    totals.set(key, entry);\n  }\n\n  return decks.map((row) =>\n    decks.map((col) => {\n      if (row.id === col.id) return null;\n      const lowId = Math.min(row.id, col.id);\n      const highId = Math.max(row.id, col.id);\n      const entry = totals.get(`${lowId}:${highId}`);\n      if (!entry) return undefined;\n      const avgFromLow = entry.sum / entry.count;\n      return row.id === lowId ? avgFromLow : 100 - avgFromLow;\n    })\n  );\n};\n\nexport default function StatsTable({ decks, matchups, embedded }: Props) {\n  const [activeTab, setActiveTab] = useState<number | null>(null);\n  const sortedDecks = useMemo(() => {\n    return decks.slice().sort((a, b) => {\n      const rankA = deckClassRank.get(a.deckClass) ?? 999;\n      const rankB = deckClassRank.get(b.deckClass) ?? 999;\n      if (rankA !== rankB) return rankA - rankB;\n      return a.id - b.id;\n    });\n  }, [decks]);\n\n  const users = useMemo(() => {\n    const seen = new Map<number, string>();\n    for (const matchup of matchups) {\n      if (!seen.has(matchup.user.id)) {\n        seen.set(matchup.user.id, matchup.user.name);\n      }\n    }\n    return Array.from(seen.entries()).map(([id, name]) => ({ id, name }));\n  }, [matchups]);\n\n  useEffect(() => {\n    if (activeTab !== null || users.length === 0) return;\n    setActiveTab(users[0].id);\n  }, [activeTab, users]);\n\n  const formatRate = (value: number | null | undefined) => {\n    if (value === null || value === undefined) return \"-\";\n    return Number.isInteger(value) ? value.toString() : value.toFixed(1);\n  };\n\n  const stats = useMemo(\n    () => buildAverageStats(sortedDecks, matchups),\n    [sortedDecks, matchups]\n  );\n  const overallMatrix = useMemo(\n    () => buildMatchupMatrix(sortedDecks, matchups),\n    [sortedDecks, matchups]\n  );\n  const activeMatchups = useMemo(() => {\n    if (!activeTab) return [];\n    return matchups.filter((matchup) => matchup.user.id === activeTab);\n  }, [activeTab, matchups]);\n  const activeMatrix = useMemo(\n    () => buildMatchupMatrix(sortedDecks, activeMatchups),\n    [sortedDecks, activeMatchups]\n  );\n\n  return (\n    <section\n      className={\n        embedded\n          ? \"bg-transparent\"\n          : \"rounded-2xl border border-zinc-200 bg-white p-6 shadow-sm\"\n      }\n    >\n      <div>\n        <p className=\"text-xs font-semibold uppercase tracking-[0.3em] text-zinc-400\">\n          Stats\n        </p>\n        <h2 className=\"mt-2 text-2xl font-semibold text-zinc-900\">\n          統計表示\n        </h2>\n      </div>\n\n      <div className=\"mt-6 overflow-x-auto\">\n        <table className=\"w-[150%] table-fixed border-collapse text-center text-sm text-zinc-700\">\n          <thead className=\"bg-white text-xs uppercase tracking-wider text-zinc-400\">\n            <tr>\n              <th className=\"w-44 border border-zinc-200 bg-white px-3 py-2 text-left text-zinc-700\">\n                デッキ\n              </th>\n              {sortedDecks.map((deck) => (\n                <th\n                  key={deck.id}\n                  className=\"min-w-[160px] border border-zinc-200 bg-white px-2 py-2 text-xs text-zinc-700\"\n                >\n                  <div\n                    className=\"max-w-[160px] text-center text-xs font-semibold text-zinc-900\"\n                    style={{\n                      display: \"-webkit-box\",\n                      WebkitLineClamp: 2,\n                      WebkitBoxOrient: \"vertical\",\n                      overflow: \"hidden\",\n                      lineHeight: \"1.2\",\n                      minHeight: \"2.4em\",\n                    }}\n                  >\n                    {deck.name}\n                  </div>\n                  <div className=\"text-[10px] text-zinc-400\">\n                    {deckClassLabels[deck.deckClass] ?? deck.deckClass}\n                  </div>\n                </th>\n              ))}\n            </tr>\n          </thead>\n          <tbody>\n            {sortedDecks.map((rowDeck, rowIndex) => (\n              <tr key={rowDeck.id}>\n              <th className=\"min-w-[200px] border border-zinc-200 bg-white px-3 py-3 text-left text-sm font-semibold text-zinc-900\">\n                <div\n                  className=\"max-w-[200px]\"\n                  style={{\n                    display: \"-webkit-box\",\n                    WebkitLineClamp: 2,\n                    WebkitBoxOrient: \"vertical\",\n                    overflow: \"hidden\",\n                    lineHeight: \"1.2\",\n                    minHeight: \"2.4em\",\n                  }}\n                >\n                  {rowDeck.name}\n                </div>\n                <div className=\"text-xs font-normal text-zinc-700\">\n                  {deckClassLabels[rowDeck.deckClass] ?? rowDeck.deckClass}\n                  {\" / \"}\n                  {rowDeck.cardPack.name}\n                </div>\n              </th>\n                {sortedDecks.map((colDeck, colIndex) => {\n                  const value = overallMatrix[rowIndex]?.[colIndex];\n                  const isSame = rowDeck.id === colDeck.id;\n                  return (\n                    <td\n                      key={colDeck.id}\n                      className=\"border border-zinc-200 px-2 py-3 text-sm\"\n                    >\n                      {isSame ? (\n                        <span className=\"text-base font-semibold text-zinc-400\">\n                          *\n                        </span>\n                      ) : value === undefined ? (\n                        <span className=\"text-zinc-400\">—</span>\n                      ) : (\n                        <span className=\"font-semibold text-zinc-900\">\n                          {formatRate(value)}\n                        </span>\n                      )}\n                    </td>\n                  );\n                })}\n              </tr>\n            ))}\n          </tbody>\n        </table>\n        {stats.length === 0 && (\n          <p className=\"mt-4 text-sm text-zinc-700\">\n            デッキが登録されていません。\n          </p>\n        )}\n      </div>\n\n      <div className=\"mt-10\">\n        <div className=\"flex flex-wrap items-center justify-between gap-3\">\n          <h3 className=\"text-lg font-semibold text-zinc-900\">\n            みんなの相性表\n          </h3>\n          <div className=\"flex flex-wrap gap-2\">\n            {users.map((user) => (\n              <button\n                key={user.id}\n                type=\"button\"\n                className={`rounded-full border px-4 py-2 text-xs font-semibold transition ${\n                  activeTab === user.id\n                    ? \"border-zinc-900 bg-white text-zinc-900\"\n                    : \"border-zinc-200 text-zinc-700 hover:bg-zinc-100\"\n                }`}\n                onClick={() => setActiveTab(user.id)}\n              >\n                {user.name}\n              </button>\n            ))}\n          </div>\n        </div>\n\n        <div className=\"mt-4 overflow-x-auto\">\n        <table className=\"w-[150%] table-fixed border-collapse text-center text-sm text-zinc-700\">\n          <thead className=\"bg-white text-xs uppercase tracking-wider text-zinc-400\">\n            <tr>\n              <th className=\"w-44 border border-zinc-200 bg-white px-3 py-2 text-left text-zinc-700\">\n                デッキ\n              </th>\n              {sortedDecks.map((deck) => (\n                <th\n                  key={deck.id}\n                  className=\"min-w-[160px] border border-zinc-200 bg-white px-2 py-2 text-xs text-zinc-700\"\n                >\n                  <div\n                    className=\"max-w-[160px] text-center text-xs font-semibold text-zinc-900\"\n                    style={{\n                      display: \"-webkit-box\",\n                      WebkitLineClamp: 2,\n                      WebkitBoxOrient: \"vertical\",\n                      overflow: \"hidden\",\n                      lineHeight: \"1.2\",\n                      minHeight: \"2.4em\",\n                    }}\n                  >\n                    {deck.name}\n                  </div>\n                  <div className=\"text-[10px] text-zinc-400\">\n                    {deckClassLabels[deck.deckClass] ?? deck.deckClass}\n                  </div>\n                </th>\n                ))}\n              </tr>\n            </thead>\n            <tbody>\n            {sortedDecks.map((rowDeck, rowIndex) => (\n              <tr key={rowDeck.id}>\n                <th className=\"min-w-[200px] border border-zinc-200 bg-white px-3 py-3 text-left text-sm font-semibold text-zinc-900\">\n                  <div\n                    className=\"max-w-[200px]\"\n                    style={{\n                      display: \"-webkit-box\",\n                      WebkitLineClamp: 2,\n                      WebkitBoxOrient: \"vertical\",\n                      overflow: \"hidden\",\n                      lineHeight: \"1.2\",\n                      minHeight: \"2.4em\",\n                    }}\n                  >\n                    {rowDeck.name}\n                  </div>\n                  <div className=\"text-xs font-normal text-zinc-700\">\n                    {deckClassLabels[rowDeck.deckClass] ?? rowDeck.deckClass}\n                    {\" / \"}\n                    {rowDeck.cardPack.name}\n                  </div>\n                </th>\n                {sortedDecks.map((colDeck, colIndex) => {\n                  const value = activeMatrix[rowIndex]?.[colIndex];\n                  const isSame = rowDeck.id === colDeck.id;\n                  return (\n                      <td\n                        key={colDeck.id}\n                        className=\"border border-zinc-200 px-2 py-3 text-sm\"\n                      >\n                        {isSame ? (\n                          <span className=\"text-base font-semibold text-zinc-400\">\n                            *\n                          </span>\n                        ) : value === undefined ? (\n                          <span className=\"text-zinc-400\">—</span>\n                        ) : (\n                          <span className=\"font-semibold text-zinc-900\">\n                            {formatRate(value)}\n                          </span>\n                        )}\n                      </td>\n                    );\n                  })}\n                </tr>\n              ))}\n            </tbody>\n          </table>\n          {users.length === 0 && (\n            <p className=\"mt-4 text-sm text-zinc-700\">\n              相性評価が登録されていません。\n            </p>\n          )}\n          {activeTab && activeMatchups.length === 0 && (\n            <p className=\"mt-4 text-sm text-zinc-700\">\n              選択したメンバーの相性評価がありません。\n            </p>\n          )}\n          {!activeTab && users.length > 0 && (\n            <p className=\"mt-4 text-sm text-zinc-700\">\n              メンバーを選択してください。\n            </p>\n          )}\n        </div>\n      </div>\n    </section>\n  );\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 572, "column": 0}, "map": {"version":3,"sources":["file:///Users/k-hosaka/Project/private-dev/shadowverse-beyond-matchup/app/components/MatchupManager.tsx"],"sourcesContent":["\"use client\";\n\nimport { useRouter } from \"next/navigation\";\nimport { useEffect, useMemo, useState, useTransition } from \"react\";\n\nimport StatsTable from \"@/app/components/StatsTable\";\n\ntype CardPack = {\n  id: number;\n  name: string;\n  releaseDate: string;\n};\n\ntype Deck = {\n  id: number;\n  name: string;\n  deckClass: string;\n  cardPack: CardPack;\n};\n\ntype Matchup = {\n  id: number;\n  deck1: Deck;\n  deck2: Deck;\n  user: User;\n  winRate: number;\n};\n\ntype Props = {\n  decks: Deck[];\n  cardPacks: CardPack[];\n  matchups: Matchup[];\n  statsMatchups: Matchup[];\n  isPublic: boolean;\n};\n\ntype User = {\n  id: number;\n  name: string;\n};\n\nconst deckClassOrder = [\n  \"ELF\",\n  \"ROYAL\",\n  \"WITCH\",\n  \"DRAGON\",\n  \"NIGHTMARE\",\n  \"BISHOP\",\n  \"NEMESIS\",\n] as const;\nconst deckClassRank = new Map<string, number>(\n  deckClassOrder.map((value, index) => [value, index])\n);\n\nconst winRateOptions = Array.from({ length: 21 }, (_, index) => index * 5);\n\ntype MatrixCell =\n  | { type: \"self\" }\n  | { type: \"empty\"; deck1Id: number; deck2Id: number }\n  | {\n      type: \"value\";\n      deck1Id: number;\n      deck2Id: number;\n      value: number;\n      recordId: number;\n      storedDeck1Id: number;\n      storedDeck2Id: number;\n      reversed: boolean;\n    };\n\nconst buildMatrix = (decks: Deck[], matchups: Matchup[]) => {\n  const direct = new Map<string, Matchup>();\n  for (const matchup of matchups) {\n    direct.set(`${matchup.deck1.id}:${matchup.deck2.id}`, matchup);\n  }\n\n  const matrix: MatrixCell[][] = decks.map((row) =>\n    decks.map((col) => {\n      if (row.id === col.id) return { type: \"self\" };\n      const key = `${row.id}:${col.id}`;\n      const reverseKey = `${col.id}:${row.id}`;\n      const directMatch = direct.get(key);\n      if (directMatch) {\n        return {\n          type: \"value\",\n          deck1Id: row.id,\n          deck2Id: col.id,\n          value: directMatch.winRate,\n          recordId: directMatch.id,\n          storedDeck1Id: directMatch.deck1.id,\n          storedDeck2Id: directMatch.deck2.id,\n          reversed: false,\n        };\n      }\n      const reverseMatch = direct.get(reverseKey);\n      if (reverseMatch) {\n        return {\n          type: \"value\",\n          deck1Id: row.id,\n          deck2Id: col.id,\n          value: 100 - reverseMatch.winRate,\n          recordId: reverseMatch.id,\n          storedDeck1Id: reverseMatch.deck1.id,\n          storedDeck2Id: reverseMatch.deck2.id,\n          reversed: true,\n        };\n      }\n      return { type: \"empty\", deck1Id: row.id, deck2Id: col.id };\n    })\n  );\n\n  return matrix;\n};\n\nexport default function MatchupManager({\n  decks,\n  cardPacks,\n  matchups,\n  statsMatchups,\n  isPublic,\n}: Props) {\n  const router = useRouter();\n  const [isPending, startTransition] = useTransition();\n  const [matrixEdit, setMatrixEdit] = useState<{\n    deck1Id: number;\n    deck2Id: number;\n    recordId?: number;\n    storedDeck1Id?: number;\n    storedDeck2Id?: number;\n    reversed?: boolean;\n  } | null>(null);\n  const [lastSaved, setLastSaved] = useState<{\n    deck1Id: number;\n    deck2Id: number;\n    value: number;\n  } | null>(null);\n  const [matrixWinRate, setMatrixWinRate] = useState(\"\");\n  const [matrixMessage, setMatrixMessage] = useState<string | null>(null);\n  const [flashMessage, setFlashMessage] = useState<string | null>(null);\n  const [error, setError] = useState<string | null>(null);\n  const [isSharing, setIsSharing] = useState(false);\n  const [activePackId, setActivePackId] = useState<number | null>(null);\n  const [activeTab, setActiveTab] = useState<\"input\" | \"stats\">(\"input\");\n  const [isPublicMatchup, setIsPublicMatchup] = useState(isPublic);\n\n  useEffect(() => {\n    if (activePackId !== null || cardPacks.length === 0) return;\n    setActivePackId(cardPacks[0].id);\n  }, [activePackId, cardPacks]);\n\n  useEffect(() => {\n    if (!flashMessage) return;\n    const timer = setTimeout(() => setFlashMessage(null), 3000);\n    return () => clearTimeout(timer);\n  }, [flashMessage]);\n\n  useEffect(() => {\n    if (!matrixMessage) return;\n    const timer = setTimeout(() => setMatrixMessage(null), 3000);\n    return () => clearTimeout(timer);\n  }, [matrixMessage]);\n\n  useEffect(() => {\n    setIsPublicMatchup(isPublic);\n  }, [isPublic]);\n\n  const filteredDecks = useMemo(() => {\n    if (!activePackId) return [];\n    return decks.filter((deck) => deck.cardPack.id === activePackId);\n  }, [activePackId, decks]);\n  const sortedDecks = useMemo(() => {\n    return filteredDecks.slice().sort((a, b) => {\n      const rankA = deckClassRank.get(a.deckClass) ?? 999;\n      const rankB = deckClassRank.get(b.deckClass) ?? 999;\n      if (rankA !== rankB) return rankA - rankB;\n      return a.id - b.id;\n    });\n  }, [filteredDecks]);\n  const filteredStatsMatchups = useMemo(() => {\n    if (!activePackId) return [];\n    return statsMatchups.filter(\n      (matchup) => matchup.deck1.cardPack.id === activePackId\n    );\n  }, [activePackId, statsMatchups]);\n\n  const filteredMatchups = useMemo(() => {\n    if (!activePackId) return [];\n    return matchups.filter(\n      (matchup) =>\n        matchup.deck1.cardPack.id === activePackId &&\n        matchup.deck2.cardPack.id === activePackId\n    );\n  }, [activePackId, matchups]);\n\n  const matchupMatrix = useMemo(\n    () => buildMatrix(sortedDecks, filteredMatchups),\n    [sortedDecks, filteredMatchups]\n  );\n  const currentValue = useMemo(() => {\n    if (!lastSaved) return null;\n    const rowIndex = sortedDecks.findIndex(\n      (deck) => deck.id === lastSaved.deck1Id\n    );\n    const colIndex = sortedDecks.findIndex(\n      (deck) => deck.id === lastSaved.deck2Id\n    );\n    if (rowIndex < 0 || colIndex < 0) return null;\n    const cell = matchupMatrix[rowIndex]?.[colIndex];\n    if (!cell || cell.type !== \"value\") return null;\n    return cell.value;\n  }, [sortedDecks, matchupMatrix, lastSaved]);\n\n  useEffect(() => {\n    if (!lastSaved || currentValue === null) return;\n    if (Math.abs(currentValue - lastSaved.value) < 0.001) {\n      setLastSaved(null);\n    }\n  }, [currentValue, lastSaved]);\n\n  const overrideValue = (rowId: number, colId: number) => {\n    if (!matrixEdit) return null;\n    if (matrixWinRate === \"\") return null;\n    const raw = Number(matrixWinRate);\n    if (!Number.isFinite(raw)) return null;\n    if (rowId === matrixEdit.deck1Id && colId === matrixEdit.deck2Id) {\n      return raw;\n    }\n    if (rowId === matrixEdit.deck2Id && colId === matrixEdit.deck1Id) {\n      return 100 - raw;\n    }\n    return null;\n  };\n\n  const pendingOverrideValue = (rowId: number, colId: number) => {\n    if (!lastSaved) return null;\n    if (rowId === lastSaved.deck1Id && colId === lastSaved.deck2Id) {\n      return lastSaved.value;\n    }\n    if (rowId === lastSaved.deck2Id && colId === lastSaved.deck1Id) {\n      return 100 - lastSaved.value;\n    }\n    return null;\n  };\n\n  const onMatrixSelect = (cell: MatrixCell) => {\n    if (cell.type === \"self\") return;\n    setError(null);\n    setFlashMessage(null);\n    setMatrixEdit({\n      deck1Id: cell.deck1Id,\n      deck2Id: cell.deck2Id,\n      recordId: cell.type === \"value\" ? cell.recordId : undefined,\n      storedDeck1Id: cell.type === \"value\" ? cell.storedDeck1Id : undefined,\n      storedDeck2Id: cell.type === \"value\" ? cell.storedDeck2Id : undefined,\n      reversed: cell.type === \"value\" ? cell.reversed : undefined,\n    });\n    setMatrixWinRate(cell.type === \"value\" ? String(cell.value) : \"\");\n  };\n\n  const onMatrixSaveValue = async (rawValue: string) => {\n    if (!matrixEdit) return;\n    const inputRate = Number(rawValue);\n    if (!Number.isFinite(inputRate)) {\n      setError(\"相性評価を選択してください。\");\n      return;\n    }\n    const payload = {\n      deck1Id: matrixEdit.recordId\n        ? (matrixEdit.storedDeck1Id ?? matrixEdit.deck1Id)\n        : matrixEdit.deck1Id,\n      deck2Id: matrixEdit.recordId\n        ? (matrixEdit.storedDeck2Id ?? matrixEdit.deck2Id)\n        : matrixEdit.deck2Id,\n      winRate:\n        matrixEdit.recordId && matrixEdit.reversed ? 100 - inputRate : inputRate,\n    };\n    const targetUrl = matrixEdit.recordId\n      ? `/api/matchups/${matrixEdit.recordId}`\n      : \"/api/matchups\";\n    const method = matrixEdit.recordId ? \"PUT\" : \"POST\";\n    const res = await fetch(targetUrl, {\n      method,\n      headers: { \"Content-Type\": \"application/json\" },\n      body: JSON.stringify(payload),\n    });\n    if (!res.ok) {\n      const data = await res.json().catch(() => ({}));\n      setError(data?.error ?? \"更新に失敗しました。\");\n      return;\n    }\n    setMatrixEdit(null);\n    setMatrixWinRate(\"\");\n    setLastSaved({\n      deck1Id: matrixEdit.deck1Id,\n      deck2Id: matrixEdit.deck2Id,\n      value: inputRate,\n    });\n    setMatrixMessage(\"更新しました！\");\n    setFlashMessage(null);\n    startTransition(() => router.refresh());\n  };\n\n  const onMatrixDelete = async () => {\n    if (!matrixEdit?.recordId) return;\n    const res = await fetch(`/api/matchups/${matrixEdit.recordId}`, {\n      method: \"DELETE\",\n    });\n    if (!res.ok) {\n      const data = await res.json().catch(() => ({}));\n      setError(data?.error ?? \"削除に失敗しました。\");\n      return;\n    }\n    setMatrixEdit(null);\n    setMatrixWinRate(\"\");\n    setFlashMessage(\"削除しました！\");\n    startTransition(() => router.refresh());\n  };\n\n  const onShareDiscord = async () => {\n    if (!activePackId) {\n      setError(\"カードパックを選択してください。\");\n      return;\n    }\n    setError(null);\n    setIsSharing(true);\n    try {\n      const res = await fetch(\"/api/discord/share-matchups\", {\n        method: \"POST\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify({ cardPackId: activePackId }),\n      });\n      if (!res.ok) {\n        const data = await res.json().catch(() => ({}));\n        throw new Error(data?.error ?? \"Discord共有に失敗しました。\");\n      }\n      setFlashMessage(\"Discordに共有しました！\");\n    } catch (err) {\n      setError(\n        err instanceof Error ? err.message : \"Discord共有に失敗しました。\"\n      );\n    } finally {\n      setIsSharing(false);\n    }\n  };\n\n  return (\n    <div className=\"space-y-8\">\n      <section className=\"rounded-2xl bg-transparent\">\n        <div className=\"flex flex-wrap gap-2 px-4 pt-3\">\n          {cardPacks.map((pack) => (\n            <button\n              key={pack.id}\n              type=\"button\"\n              className={`relative -mb-px rounded-t-xl border border-b-0 px-5 py-2 text-xs font-semibold transition ${\n                activePackId === pack.id\n                  ? \"border-zinc-900 bg-white text-zinc-900\"\n                  : \"border-zinc-200 bg-zinc-100 text-zinc-700 hover:bg-zinc-100\"\n              }`}\n              onClick={() => setActivePackId(pack.id)}\n            >\n              {pack.name}\n            </button>\n          ))}\n        </div>\n        <div className=\"-mt-px rounded-t-2xl rounded-b-2xl border-x border-b border-zinc-200 bg-white p-6 shadow-sm\">\n          <div>\n            <p className=\"text-xs font-semibold uppercase tracking-[0.3em] text-zinc-400\">\n              Matchups\n            </p>\n            <h2 className=\"mt-2 text-2xl font-semibold text-zinc-900\">\n              相性登録\n            </h2>\n          </div>\n          <div className=\"mt-6 flex flex-wrap gap-2\">\n            <button\n              type=\"button\"\n              className={`rounded-full border px-4 py-2 text-xs font-semibold transition ${\n                activeTab === \"input\"\n                  ? \"border-zinc-900 bg-white text-zinc-900\"\n                  : \"border-zinc-200 text-zinc-700 hover:bg-zinc-100\"\n              }`}\n              onClick={() => setActiveTab(\"input\")}\n            >\n              相性入力\n            </button>\n            <button\n              type=\"button\"\n              className={`rounded-full border px-4 py-2 text-xs font-semibold transition ${\n                activeTab === \"stats\"\n                  ? \"border-zinc-900 bg-white text-zinc-900\"\n                  : \"border-zinc-200 text-zinc-700 hover:bg-zinc-100\"\n              }`}\n              onClick={() => setActiveTab(\"stats\")}\n            >\n              統計\n            </button>\n          </div>\n\n          {activeTab === \"stats\" && (\n            <div className=\"mt-8 border-t border-zinc-200 pt-8\">\n              <StatsTable\n                decks={sortedDecks}\n                matchups={filteredStatsMatchups}\n                embedded\n              />\n            </div>\n          )}\n\n          {flashMessage && (\n            <div className=\"flash-in fixed left-1/2 top-4 z-50 w-[min(90vw,420px)] -translate-x-1/2 rounded-full border border-emerald-200 bg-emerald-50 px-4 py-2 text-center text-sm font-semibold text-emerald-700 shadow-sm\">\n              {flashMessage}\n            </div>\n          )}\n          {activeTab === \"input\" && matrixMessage && (\n            <div className=\"flash-in fixed left-1/2 top-4 z-50 w-[min(90vw,420px)] -translate-x-1/2 rounded-full border border-emerald-200 bg-emerald-50 px-4 py-2 text-center text-sm font-semibold text-emerald-700 shadow-sm\">\n              {matrixMessage}\n            </div>\n          )}\n\n          {activeTab === \"input\" && (\n            <div className=\"mt-6 overflow-x-auto\">\n              <table className=\"w-[150%] table-fixed border-collapse text-center text-[11px] text-zinc-700\">\n                <thead className=\"bg-white text-xs uppercase tracking-wider text-zinc-400\">\n                  <tr>\n                    <th className=\"w-[18%] border border-zinc-200 bg-white px-2 py-2 text-left text-zinc-700\">\n                      デッキ\n                    </th>\n                    {sortedDecks.map((deck) => (\n                      <th\n                        key={deck.id}\n                        className=\"border border-zinc-200 bg-white px-1 py-2 text-zinc-700\"\n                      >\n                        <div\n                          className=\"text-center font-semibold text-zinc-900\"\n                          style={{\n                            display: \"-webkit-box\",\n                            WebkitLineClamp: 2,\n                            WebkitBoxOrient: \"vertical\",\n                            overflow: \"hidden\",\n                            lineHeight: \"1.2\",\n                            minHeight: \"2.4em\",\n                          }}\n                        >\n                          {deck.name}\n                        </div>\n                      </th>\n                    ))}\n                  </tr>\n                </thead>\n                <tbody>\n                  {sortedDecks.map((rowDeck, rowIndex) => (\n                    <tr key={rowDeck.id}>\n                      <th className=\"border border-zinc-200 bg-white px-2 py-3 text-left font-semibold text-zinc-900\">\n                        <div\n                          className=\"whitespace-normal\"\n                          style={{\n                            display: \"-webkit-box\",\n                            WebkitLineClamp: 2,\n                            WebkitBoxOrient: \"vertical\",\n                            overflow: \"hidden\",\n                            lineHeight: \"1.2\",\n                            minHeight: \"2.4em\",\n                          }}\n                        >\n                          {rowDeck.name}\n                        </div>\n                      </th>\n                      {sortedDecks.map((colDeck, colIndex) => {\n                        const cell = matchupMatrix[rowIndex]?.[colIndex];\n                        const isSelf = cell?.type === \"self\";\n                        const display =\n                          cell?.type === \"value\" ? cell.value : undefined;\n                        const override =\n                          overrideValue(rowDeck.id, colDeck.id) ??\n                          pendingOverrideValue(rowDeck.id, colDeck.id);\n                        return (\n                          <td\n                            key={colDeck.id}\n                            className={`border border-zinc-200 px-2 py-3 text-sm ${\n                              isSelf ? \"bg-zinc-50\" : \"hover:bg-zinc-100\"\n                            }`}\n                          >\n                            {isSelf ? (\n                              <span className=\"text-base font-semibold text-zinc-400\">\n                                *\n                              </span>\n                            ) : (\n                              matrixEdit &&\n                              matrixEdit.deck1Id === rowDeck.id &&\n                              matrixEdit.deck2Id === colDeck.id ? (\n                                <select\n                                  className=\"w-full rounded-md border border-zinc-200 bg-white px-1 py-1 text-xs font-semibold text-zinc-900\"\n                                  value={matrixWinRate}\n                                  onChange={async (event) => {\n                                    const value = event.target.value;\n                                    if (!value) return;\n                                    if (value === \"delete\") {\n                                      await onMatrixDelete();\n                                      return;\n                                    }\n                                    setMatrixWinRate(value);\n                                    await onMatrixSaveValue(value);\n                                  }}\n                                >\n                                  <option value=\"\">選択してください</option>\n                                  {winRateOptions.map((value) => (\n                                    <option key={value} value={value}>\n                                      {value}\n                                    </option>\n                                  ))}\n                                  {matrixEdit.recordId && (\n                                    <option value=\"delete\">削除</option>\n                                  )}\n                                </select>\n                              ) : (\n                                <button\n                                  type=\"button\"\n                                  className=\"w-full font-semibold text-zinc-900\"\n                                  onClick={() => cell && onMatrixSelect(cell)}\n                                >\n                                  {override !== null\n                                    ? override\n                                    : display === undefined\n                                      ? \"—\"\n                                      : display}\n                                </button>\n                              )\n                            )}\n                          </td>\n                        );\n                      })}\n                    </tr>\n                  ))}\n                </tbody>\n              </table>\n              {sortedDecks.length === 0 && (\n                <p className=\"mt-4 text-sm text-zinc-700\">\n                  このカードパックのデッキがありません。\n                </p>\n              )}\n            </div>\n          )}\n          {activeTab === \"input\" && (\n            <div className=\"mt-4 flex justify-end\">\n              <button\n                type=\"button\"\n                className=\"rounded-lg border border-zinc-200 bg-white px-4 py-2 text-xs font-semibold text-zinc-700 hover:bg-zinc-100 disabled:cursor-not-allowed disabled:opacity-60\"\n                onClick={onShareDiscord}\n                disabled={isSharing || sortedDecks.length === 0}\n              >\n                {isSharing ? \"Discordに共有中...\" : \"Discordで共有\"}\n              </button>\n            </div>\n          )}\n          {activeTab === \"input\" && (\n            <div className=\"mt-4 flex flex-wrap items-center justify-between gap-3 rounded-lg border border-zinc-200 bg-white px-4 py-3 text-sm\">\n              <div>\n                <p className=\"font-semibold text-zinc-900\">相性表の公開設定</p>\n                <p className=\"text-xs text-zinc-700\">\n                  公開にすると、統計タブであなたの相性表が集計されます。\n                </p>\n              </div>\n              <label className=\"flex items-center gap-3 text-xs font-semibold text-zinc-700\">\n                <span>{isPublicMatchup ? \"公開\" : \"非公開\"}</span>\n                <input\n                  type=\"checkbox\"\n                  className=\"peer sr-only\"\n                  checked={isPublicMatchup}\n                  onChange={async () => {\n                    const nextValue = !isPublicMatchup;\n                    setIsPublicMatchup(nextValue);\n                    setError(null);\n                    try {\n                      const res = await fetch(\n                        \"/api/settings/matchup-visibility\",\n                        {\n                          method: \"PATCH\",\n                          headers: { \"Content-Type\": \"application/json\" },\n                          body: JSON.stringify({ isPublic: nextValue }),\n                        }\n                      );\n                      if (!res.ok) {\n                        const data = await res.json().catch(() => null);\n                        throw new Error(data?.error ?? \"更新に失敗しました。\");\n                      }\n                      setFlashMessage(\"更新しました！\");\n                      startTransition(() => router.refresh());\n                    } catch (err) {\n                      setIsPublicMatchup(!nextValue);\n                      setError(\n                        err instanceof Error\n                          ? err.message\n                          : \"更新に失敗しました。\"\n                      );\n                    }\n                  }}\n                />\n                <span className=\"relative inline-flex h-6 w-11 items-center rounded-full border border-zinc-200 bg-zinc-100 transition peer-checked:border-emerald-600 peer-checked:bg-emerald-600\">\n                  <span className=\"absolute left-0.5 top-0.5 h-5 w-5 rounded-full bg-white shadow transition peer-checked:translate-x-5\" />\n                </span>\n              </label>\n            </div>\n          )}\n\n        </div>\n      </section>\n    </div>\n  );\n}\n"],"names":[],"mappings":"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"}}]
}