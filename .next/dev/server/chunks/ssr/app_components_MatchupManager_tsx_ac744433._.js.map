{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/k-hosaka/Project/private-dev/shadowverse-beyond-matchup/app/components/MatchupManager.tsx"],"sourcesContent":["\"use client\";\n\nimport { useRouter } from \"next/navigation\";\nimport { useEffect, useMemo, useState, useTransition } from \"react\";\n\ntype CardPack = {\n  id: number;\n  name: string;\n  releaseDate: string;\n};\n\ntype Deck = {\n  id: number;\n  name: string;\n  deckClass: string;\n  cardPack: CardPack;\n};\n\ntype Matchup = {\n  id: number;\n  deck1: Deck;\n  deck2: Deck;\n  user: User;\n  winRate: number;\n};\n\ntype Props = {\n  decks: Deck[];\n  cardPacks: CardPack[];\n  matchups: Matchup[];\n};\n\ntype User = {\n  id: number;\n  name: string;\n};\n\nconst deckClassLabels: Record<string, string> = {\n  ELF: \"エルフ\",\n  ROYAL: \"ロイヤル\",\n  WITCH: \"ウィッチ\",\n  NIGHTMARE: \"ナイトメア\",\n  DRAGON: \"ドラゴン\",\n  BISHOP: \"ビショップ\",\n  NEMESIS: \"ネメシス\",\n};\n\nconst winRateOptions = Array.from({ length: 21 }, (_, index) => index * 5);\n\ntype MatrixCell =\n  | { type: \"self\" }\n  | { type: \"empty\"; deck1Id: number; deck2Id: number }\n  | {\n      type: \"value\";\n      deck1Id: number;\n      deck2Id: number;\n      value: number;\n      recordId: number;\n      storedDeck1Id: number;\n      storedDeck2Id: number;\n      reversed: boolean;\n    };\n\nconst buildMatrix = (decks: Deck[], matchups: Matchup[]) => {\n  const direct = new Map<string, Matchup>();\n  for (const matchup of matchups) {\n    direct.set(`${matchup.deck1.id}:${matchup.deck2.id}`, matchup);\n  }\n\n  const matrix: MatrixCell[][] = decks.map((row) =>\n    decks.map((col) => {\n      if (row.id === col.id) return { type: \"self\" };\n      const key = `${row.id}:${col.id}`;\n      const reverseKey = `${col.id}:${row.id}`;\n      const directMatch = direct.get(key);\n      if (directMatch) {\n        return {\n          type: \"value\",\n          deck1Id: row.id,\n          deck2Id: col.id,\n          value: directMatch.winRate,\n          recordId: directMatch.id,\n          storedDeck1Id: directMatch.deck1.id,\n          storedDeck2Id: directMatch.deck2.id,\n          reversed: false,\n        };\n      }\n      const reverseMatch = direct.get(reverseKey);\n      if (reverseMatch) {\n        return {\n          type: \"value\",\n          deck1Id: row.id,\n          deck2Id: col.id,\n          value: 100 - reverseMatch.winRate,\n          recordId: reverseMatch.id,\n          storedDeck1Id: reverseMatch.deck1.id,\n          storedDeck2Id: reverseMatch.deck2.id,\n          reversed: true,\n        };\n      }\n      return { type: \"empty\", deck1Id: row.id, deck2Id: col.id };\n    })\n  );\n\n  return matrix;\n};\n\nexport default function MatchupManager({ decks, cardPacks, matchups }: Props) {\n  const router = useRouter();\n  const [isPending, startTransition] = useTransition();\n  const [matrixEdit, setMatrixEdit] = useState<{\n    deck1Id: number;\n    deck2Id: number;\n    recordId?: number;\n    storedDeck1Id?: number;\n    storedDeck2Id?: number;\n    reversed?: boolean;\n  } | null>(null);\n  const [lastSaved, setLastSaved] = useState<{\n    deck1Id: number;\n    deck2Id: number;\n    value: number;\n  } | null>(null);\n  const [matrixWinRate, setMatrixWinRate] = useState(\"\");\n  const [matrixMessage, setMatrixMessage] = useState<string | null>(null);\n  const [error, setError] = useState<string | null>(null);\n  const [deckName, setDeckName] = useState(\"\");\n  const [deckClass, setDeckClass] = useState(\"\");\n  const [cardPackId, setCardPackId] = useState(\"\");\n  const [editingDeckId, setEditingDeckId] = useState<number | null>(null);\n  const [activePackId, setActivePackId] = useState<number | null>(null);\n\n  useEffect(() => {\n    if (activePackId !== null || cardPacks.length === 0) return;\n    setActivePackId(cardPacks[0].id);\n  }, [activePackId, cardPacks]);\n\n  useEffect(() => {\n    if (!activePackId) return;\n    setCardPackId(String(activePackId));\n  }, [activePackId]);\n\n  const filteredDecks = useMemo(() => {\n    if (!activePackId) return [];\n    return decks.filter((deck) => deck.cardPack.id === activePackId);\n  }, [activePackId, decks]);\n\n  const filteredMatchups = useMemo(() => {\n    if (!activePackId) return [];\n    return matchups.filter(\n      (matchup) =>\n        matchup.deck1.cardPack.id === activePackId &&\n        matchup.deck2.cardPack.id === activePackId\n    );\n  }, [activePackId, matchups]);\n\n  const matchupMatrix = useMemo(\n    () => buildMatrix(filteredDecks, filteredMatchups),\n    [filteredDecks, filteredMatchups]\n  );\n  const currentValue = useMemo(() => {\n    if (!lastSaved) return null;\n    const rowIndex = filteredDecks.findIndex(\n      (deck) => deck.id === lastSaved.deck1Id\n    );\n    const colIndex = filteredDecks.findIndex(\n      (deck) => deck.id === lastSaved.deck2Id\n    );\n    if (rowIndex < 0 || colIndex < 0) return null;\n    const cell = matchupMatrix[rowIndex]?.[colIndex];\n    if (!cell || cell.type !== \"value\") return null;\n    return cell.value;\n  }, [filteredDecks, matchupMatrix, lastSaved]);\n\n  useEffect(() => {\n    if (!lastSaved || currentValue === null) return;\n    if (Math.abs(currentValue - lastSaved.value) < 0.001) {\n      setLastSaved(null);\n    }\n  }, [currentValue, lastSaved]);\n\n  const overrideValue = (rowId: number, colId: number) => {\n    if (!matrixEdit) return null;\n    const raw = Number(matrixWinRate);\n    if (!Number.isFinite(raw)) return null;\n    if (rowId === matrixEdit.deck1Id && colId === matrixEdit.deck2Id) {\n      return raw;\n    }\n    if (rowId === matrixEdit.deck2Id && colId === matrixEdit.deck1Id) {\n      return 100 - raw;\n    }\n    return null;\n  };\n\n  const pendingOverrideValue = (rowId: number, colId: number) => {\n    if (!lastSaved) return null;\n    if (rowId === lastSaved.deck1Id && colId === lastSaved.deck2Id) {\n      return lastSaved.value;\n    }\n    if (rowId === lastSaved.deck2Id && colId === lastSaved.deck1Id) {\n      return 100 - lastSaved.value;\n    }\n    return null;\n  };\n\n  const onMatrixSelect = (cell: MatrixCell) => {\n    if (cell.type === \"self\") return;\n    setError(null);\n    setMatrixEdit({\n      deck1Id: cell.deck1Id,\n      deck2Id: cell.deck2Id,\n      recordId: cell.type === \"value\" ? cell.recordId : undefined,\n      storedDeck1Id: cell.type === \"value\" ? cell.storedDeck1Id : undefined,\n      storedDeck2Id: cell.type === \"value\" ? cell.storedDeck2Id : undefined,\n      reversed: cell.type === \"value\" ? cell.reversed : undefined,\n    });\n    setMatrixWinRate(cell.type === \"value\" ? String(cell.value) : \"\");\n  };\n\n  const onMatrixSave = async () => {\n    if (!matrixEdit) return;\n    const inputRate = Number(matrixWinRate);\n    if (!Number.isFinite(inputRate)) {\n      setError(\"相性評価を選択してください。\");\n      return;\n    }\n    const payload = {\n      deck1Id: matrixEdit.recordId\n        ? (matrixEdit.storedDeck1Id ?? matrixEdit.deck1Id)\n        : matrixEdit.deck1Id,\n      deck2Id: matrixEdit.recordId\n        ? (matrixEdit.storedDeck2Id ?? matrixEdit.deck2Id)\n        : matrixEdit.deck2Id,\n      winRate:\n        matrixEdit.recordId && matrixEdit.reversed ? 100 - inputRate : inputRate,\n    };\n    const targetUrl = matrixEdit.recordId\n      ? `/api/matchups/${matrixEdit.recordId}`\n      : \"/api/matchups\";\n    const method = matrixEdit.recordId ? \"PUT\" : \"POST\";\n    const res = await fetch(targetUrl, {\n      method,\n      headers: { \"Content-Type\": \"application/json\" },\n      body: JSON.stringify(payload),\n    });\n    if (!res.ok) {\n      const data = await res.json().catch(() => ({}));\n      setError(data?.error ?? \"更新に失敗しました。\");\n      return;\n    }\n    setMatrixEdit(null);\n    setMatrixWinRate(\"\");\n    setLastSaved({\n      deck1Id: matrixEdit.deck1Id,\n      deck2Id: matrixEdit.deck2Id,\n      value: Number(matrixWinRate),\n    });\n    setMatrixMessage(\"更新しました！\");\n    startTransition(() => router.refresh());\n  };\n\n  const onMatrixDelete = async () => {\n    if (!matrixEdit?.recordId) return;\n    const res = await fetch(`/api/matchups/${matrixEdit.recordId}`, {\n      method: \"DELETE\",\n    });\n    if (!res.ok) {\n      const data = await res.json().catch(() => ({}));\n      setError(data?.error ?? \"削除に失敗しました。\");\n      return;\n    }\n    setMatrixEdit(null);\n    setMatrixWinRate(\"\");\n    startTransition(() => router.refresh());\n  };\n\n  const onDeckSubmit = async (event: React.FormEvent<HTMLFormElement>) => {\n    event.preventDefault();\n    setError(null);\n\n    if (deckName.trim().length < 1 || deckName.trim().length > 100) {\n      setError(\"デッキ名は1〜100文字で入力してください。\");\n      return;\n    }\n    if (!deckClass) {\n      setError(\"クラスを選択してください。\");\n      return;\n    }\n    if (!cardPackId) {\n      setError(\"カードパックを選択してください。\");\n      return;\n    }\n\n    const targetUrl = editingDeckId ? `/api/decks/${editingDeckId}` : \"/api/decks\";\n    const method = editingDeckId ? \"PUT\" : \"POST\";\n    const res = await fetch(targetUrl, {\n      method,\n      headers: { \"Content-Type\": \"application/json\" },\n      body: JSON.stringify({\n        name: deckName.trim(),\n        deckClass,\n        cardPackId: Number(cardPackId),\n      }),\n    });\n\n    if (!res.ok) {\n      const data = await res.json().catch(() => ({}));\n      setError(data?.error ?? \"登録に失敗しました。\");\n      return;\n    }\n\n    setDeckName(\"\");\n    setDeckClass(\"\");\n    setCardPackId(activePackId ? String(activePackId) : \"\");\n    setEditingDeckId(null);\n    startTransition(() => router.refresh());\n  };\n\n  const onDeckEdit = (deck: Deck) => {\n    setDeckName(deck.name);\n    setDeckClass(deck.deckClass);\n    setCardPackId(String(deck.cardPack.id));\n    setEditingDeckId(deck.id);\n  };\n\n  const onDeckDelete = async (id: number) => {\n    setError(null);\n    const res = await fetch(`/api/decks/${id}`, { method: \"DELETE\" });\n    if (!res.ok) {\n      const data = await res.json().catch(() => ({}));\n      setError(data?.error ?? \"削除に失敗しました。\");\n      return;\n    }\n    startTransition(() => router.refresh());\n  };\n\n  return (\n    <div className=\"space-y-8\">\n      <section className=\"rounded-2xl bg-transparent\">\n        <div className=\"flex flex-wrap gap-2 px-4 pt-3\">\n          {cardPacks.map((pack) => (\n            <button\n              key={pack.id}\n              type=\"button\"\n              className={`relative -mb-px rounded-t-xl border border-b-0 px-5 py-2 text-xs font-semibold transition ${\n                activePackId === pack.id\n                  ? \"border-zinc-900 bg-white text-zinc-900\"\n                  : \"border-zinc-200 bg-zinc-100 text-zinc-600 hover:bg-zinc-200\"\n              }`}\n              onClick={() => setActivePackId(pack.id)}\n            >\n              {pack.name}\n            </button>\n          ))}\n        </div>\n        <div className=\"-mt-px rounded-t-2xl rounded-b-2xl border-x border-b border-zinc-200 bg-white p-6 shadow-sm\">\n          <div>\n            <p className=\"text-xs font-semibold uppercase tracking-[0.3em] text-zinc-400\">\n              Matchups\n            </p>\n            <h2 className=\"mt-2 text-2xl font-semibold text-zinc-900\">\n              相性登録\n            </h2>\n          </div>\n          {matrixMessage && (\n            <p className=\"mt-4 text-sm font-semibold text-emerald-600\">\n              {matrixMessage}\n            </p>\n          )}\n\n          <div className=\"mt-6 overflow-x-auto\">\n            <table className=\"min-w-full table-fixed border-collapse text-center text-sm text-zinc-700\">\n              <thead className=\"bg-white text-xs uppercase tracking-wider text-zinc-400\">\n                <tr>\n                  <th className=\"w-44 border border-zinc-300 bg-white px-3 py-2 text-left text-zinc-500\">\n                    デッキ\n                  </th>\n                  {filteredDecks.map((deck) => (\n                    <th\n                      key={deck.id}\n                      className=\"min-w-[110px] border border-zinc-300 bg-white px-2 py-2 text-xs text-zinc-500\"\n                    >\n                      <div className=\"font-semibold text-zinc-900\">\n                        {deck.name}\n                      </div>\n                    </th>\n                  ))}\n                </tr>\n              </thead>\n              <tbody>\n                {filteredDecks.map((rowDeck, rowIndex) => (\n                  <tr key={rowDeck.id}>\n                    <th className=\"border border-zinc-300 bg-white px-3 py-3 text-left text-sm font-semibold text-zinc-900\">\n                      {rowDeck.name}\n                    </th>\n                    {filteredDecks.map((colDeck, colIndex) => {\n                      const cell = matchupMatrix[rowIndex]?.[colIndex];\n                      const isSelf = cell?.type === \"self\";\n                      const display =\n                        cell?.type === \"value\" ? cell.value : undefined;\n                      const override =\n                        overrideValue(rowDeck.id, colDeck.id) ??\n                        pendingOverrideValue(rowDeck.id, colDeck.id);\n                      return (\n                        <td\n                          key={colDeck.id}\n                          className={`border border-zinc-300 px-2 py-3 text-sm ${\n                            isSelf ? \"bg-zinc-50\" : \"hover:bg-zinc-100\"\n                          }`}\n                        >\n                          {isSelf ? (\n                            <span className=\"text-base font-semibold text-zinc-400\">\n                              *\n                            </span>\n                          ) : (\n                            <button\n                              type=\"button\"\n                              className=\"w-full font-semibold text-zinc-900\"\n                              onClick={() => cell && onMatrixSelect(cell)}\n                            >\n                              {override !== null\n                                ? override\n                                : display === undefined\n                                  ? \"—\"\n                                  : display}\n                            </button>\n                          )}\n                        </td>\n                      );\n                    })}\n                  </tr>\n                ))}\n              </tbody>\n            </table>\n            {filteredDecks.length === 0 && (\n              <p className=\"mt-4 text-sm text-zinc-500\">\n                このカードパックのデッキがありません。\n              </p>\n            )}\n          </div>\n\n          {matrixEdit && (\n            <div className=\"mt-6 rounded-xl border border-zinc-200 bg-zinc-50 px-4 py-4\">\n              <div className=\"flex flex-wrap items-center justify-between gap-4\">\n                <div>\n                  <p className=\"text-sm font-semibold text-zinc-900\">\n                    相性の編集\n                  </p>\n                  <p className=\"text-xs text-zinc-500\">\n                    {filteredDecks.find((deck) => deck.id === matrixEdit.deck1Id)\n                      ?.name}{\" \"}\n                    vs{\" \"}\n                    {filteredDecks.find((deck) => deck.id === matrixEdit.deck2Id)\n                      ?.name}\n                  </p>\n                </div>\n                <div className=\"flex flex-wrap items-center gap-2\">\n                  <select\n                    className=\"rounded-lg border border-zinc-200 px-3 py-2 text-sm text-zinc-900 focus:border-zinc-400 focus:outline-none\"\n                    value={matrixWinRate}\n                    onChange={(event) => setMatrixWinRate(event.target.value)}\n                  >\n                    <option value=\"\">選択してください</option>\n                    {winRateOptions.map((value) => (\n                      <option key={value} value={value}>\n                        {value}\n                      </option>\n                    ))}\n                  </select>\n                  <button\n                    type=\"button\"\n                    className=\"rounded-lg bg-zinc-900 px-4 py-2 text-xs font-semibold text-white hover:bg-zinc-800\"\n                    onClick={onMatrixSave}\n                  >\n                    保存\n                  </button>\n                  {matrixEdit.recordId && (\n                    <button\n                      type=\"button\"\n                      className=\"rounded-lg border border-zinc-200 px-4 py-2 text-xs font-semibold text-zinc-700 hover:bg-zinc-100\"\n                      onClick={onMatrixDelete}\n                    >\n                      削除\n                    </button>\n                  )}\n                  <button\n                    type=\"button\"\n                    className=\"rounded-lg border border-zinc-200 px-4 py-2 text-xs font-semibold text-zinc-700 hover:bg-zinc-100\"\n                    onClick={() => setMatrixEdit(null)}\n                  >\n                    閉じる\n                  </button>\n                </div>\n              </div>\n            </div>\n          )}\n\n          <div className=\"mt-10 border-t border-zinc-100 pt-8\">\n            <div>\n              <p className=\"text-xs font-semibold uppercase tracking-[0.3em] text-zinc-400\">\n                Decks\n              </p>\n              <h2 className=\"mt-2 text-2xl font-semibold text-zinc-900\">\n                {editingDeckId ? \"デッキの編集\" : \"デッキ追加\"}\n              </h2>\n            </div>\n\n            <form\n              className=\"mt-6 grid gap-4 md:grid-cols-3\"\n              onSubmit={onDeckSubmit}\n            >\n              <label className=\"flex flex-col gap-2 text-sm text-zinc-700\">\n                クラス\n                <select\n                  className=\"rounded-lg border border-zinc-200 px-3 py-2 text-sm text-zinc-900 focus:border-zinc-400 focus:outline-none\"\n                  value={deckClass}\n                  onChange={(event) => setDeckClass(event.target.value)}\n                >\n                  <option value=\"\">選択してください</option>\n                  {Object.entries(deckClassLabels).map(([value, label]) => (\n                    <option key={value} value={value}>\n                      {label}\n                    </option>\n                  ))}\n                </select>\n              </label>\n              <label className=\"flex flex-col gap-2 text-sm text-zinc-700 md:col-span-2\">\n                デッキ名\n                <input\n                  className=\"rounded-lg border border-zinc-200 px-3 py-2 text-sm text-zinc-900 focus:border-zinc-400 focus:outline-none\"\n                  value={deckName}\n                  onChange={(event) => setDeckName(event.target.value)}\n                  placeholder=\"デッキ名を入力\"\n                />\n              </label>\n              <div className=\"flex flex-col gap-2 text-sm text-zinc-700 md:col-span-2\">\n                カードパック\n                <div className=\"rounded-lg border border-zinc-200 bg-zinc-50 px-3 py-2 text-sm text-zinc-700\">\n                  {cardPacks.find((pack) => pack.id === activePackId)?.name ??\n                    \"未選択\"}\n                </div>\n              </div>\n              <div className=\"flex items-end\">\n                <button\n                  className=\"w-full rounded-lg bg-zinc-900 px-4 py-2 text-sm font-semibold text-white hover:bg-zinc-800 disabled:cursor-not-allowed disabled:bg-zinc-400\"\n                  type=\"submit\"\n                  disabled={isPending}\n                >\n                  {editingDeckId ? \"更新する\" : \"追加する\"}\n                </button>\n              </div>\n            </form>\n            {error && <p className=\"mt-3 text-sm text-red-600\">{error}</p>}\n          </div>\n\n          <div className=\"mt-10 border-t border-zinc-100 pt-8\">\n            <div className=\"flex items-center justify-between\">\n              <h3 className=\"text-lg font-semibold text-zinc-900\">\n                登録済みデッキ\n              </h3>\n              <span className=\"text-sm text-zinc-500\">\n                {filteredDecks.length}件\n              </span>\n            </div>\n            <div className=\"mt-4 space-y-3\">\n              {filteredDecks.length === 0 && (\n                <p className=\"text-sm text-zinc-500\">まだ登録がありません。</p>\n              )}\n              {filteredDecks.map((deck) => (\n                <div\n                  key={deck.id}\n                  className=\"flex flex-wrap items-center justify-between gap-3 rounded-lg border border-zinc-100 bg-zinc-50 px-4 py-3\"\n                >\n                  <div>\n                    <p className=\"text-sm font-semibold text-zinc-900\">\n                      {deck.name}\n                    </p>\n                    <p className=\"text-xs text-zinc-500\">\n                      {deckClassLabels[deck.deckClass] ?? deck.deckClass} /{\" \"}\n                      {deck.cardPack.name}\n                    </p>\n                  </div>\n                  <div className=\"flex items-center gap-3\">\n                    <button\n                      className=\"text-sm font-semibold text-zinc-700 hover:text-zinc-900\"\n                      onClick={() => onDeckEdit(deck)}\n                      type=\"button\"\n                    >\n                      編集\n                    </button>\n                    <button\n                      className=\"text-sm font-semibold text-red-600 hover:text-red-700\"\n                      onClick={() => onDeckDelete(deck.id)}\n                      type=\"button\"\n                    >\n                      削除\n                    </button>\n                  </div>\n                </div>\n              ))}\n            </div>\n          </div>\n        </div>\n      </section>\n    </div>\n  );\n}\n"],"names":[],"mappings":"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"}}]
}